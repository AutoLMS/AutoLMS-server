# AutoLMS 업데이트 안내

## 변경 사항

이번 업데이트에서는 첨부파일 처리 방식을 개선하여 기존 데이터와의 호환성을 강화했습니다.

### 주요 변경 사항

1. `Attachment` 모델에 `user_id` 필드 추가
2. 첨부파일 API 엔드포인트 개선
3. 첨부파일 다운로드 기능 개선
4. 기존 데이터 마이그레이션 스크립트 추가

## 적용 방법

### 1. 코드 업데이트

최신 코드를 다운로드하거나 변경 사항을 적용하세요.

### 2. 데이터베이스 마이그레이션

다음 명령을 실행하여 기존 첨부파일에 `user_id` 필드를 추가합니다:

```bash
python migrate_attachments.py
```

이 스크립트는 첨부파일의 `course_id`를 기반으로 해당 강의의 소유자 ID를 첨부파일의 `user_id`로 설정합니다.

## 기술적 변경 사항

### 모델 변경

- `Attachment` 모델에 `user_id` 필드 추가
- `to_dict()` 메서드에 `user_id`와 `file_url` 필드 추가

### API 엔드포인트 개선

- 첨부파일 다운로드 엔드포인트가 Supabase 스토리지 URL을 사용하도록 수정
- 첨부파일 조회 및 검색 엔드포인트 개선

### 크롤링 기능 개선

- 첨부파일 생성 시 `user_id` 필드 설정
- 과제 첨부파일에 `original_url` 필드 추가

## 주의 사항

- 이 업데이트는 기존 데이터와의 호환성을 위한 것이므로, 기존 데이터를 변경하지 않습니다.
- 마이그레이션 스크립트는 기존 첨부파일에 `user_id` 필드를 추가하지만, 기존 데이터의 구조는 유지됩니다.